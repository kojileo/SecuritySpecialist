# テンペスト攻撃入門

## テンペスト攻撃とは

**テンペスト攻撃（TEMPEST Attack）**は、電子機器から漏洩する電磁波や音響を利用して、機密情報を盗み取るサイドチャネル攻撃の一種です。コンピュータやスマートフォンなどの電子機器が発する微弱な電磁波や音響を解析することで、画面表示内容やキーボード入力、暗号化処理などの情報を外部から取得する攻撃手法です。

## なぜテンペスト攻撃が可能なのか

### 物理的な原理
- **電磁波の漏洩**: 電子回路から必ず電磁波が発生
- **音響の発生**: キーボードやファンの動作音
- **距離の影響**: 近距離では微弱な信号も検出可能
- **技術の進歩**: 高感度な受信装置の普及

### 攻撃の特徴
- **物理的接近**: 攻撃対象に近づく必要
- **専門機器**: 高価な受信・解析装置が必要
- **技術的難易度**: 高度な技術と知識が必要
- **検出困難**: 通常のセキュリティ対策では発見困難

## テンペスト攻撃の種類

### 1. 電磁波攻撃

| 種類 | 対象 | 距離 | 取得可能な情報 |
|------|------|------|----------------|
| **近傍電界** | キーボード、マウス | 数cm | キー入力、クリック |
| **近傍磁界** | ケーブル、回路 | 数m | データ転送 |
| **遠方電界** | ディスプレイ | 数十m | 画面表示内容 |
| **遠方磁界** | 電源線 | 数m | 処理内容 |

### 2. 音響攻撃

| 種類 | 対象 | 取得可能な情報 |
|------|------|----------------|
| **キーボード音** | キーボード | 入力文字 |
| **ファン音** | CPUファン | 処理負荷 |
| **プリンター音** | プリンター | 印刷内容 |
| **ハードディスク音** | HDD | アクセスパターン |

## 攻撃の手順

### 1. 事前調査
```
[対象の特定] → [環境の調査] → [攻撃計画の立案]
```

### 2. 攻撃の実行
```
[機器の設置] → [信号の受信] → [データの解析] → [情報の抽出]
```

### 3. 情報の活用
```
[機密情報の取得] → [暗号鍵の復元] → [システムへの侵入]
```

## 具体的な攻撃例

### 1. ディスプレイ攻撃
- **対象**: CRT、LCD、OLEDディスプレイ
- **方法**: 電磁波の解析
- **取得情報**: 画面表示内容、文字、画像

### 2. キーボード攻撃
- **対象**: 有線・無線キーボード
- **方法**: 電磁波・音響の解析
- **取得情報**: パスワード、入力文字

### 3. 暗号処理攻撃
- **対象**: 暗号化チップ、CPU
- **方法**: 電磁波の解析
- **取得情報**: 暗号鍵、平文

### 4. スマートフォン攻撃
- **対象**: スマートフォンの画面・入力
- **方法**: 電磁波・音響の解析
- **取得情報**: PIN、パスワード、画面内容

## 防御対策

### 1. 物理的対策

| 対策 | 効果 | コスト | 実装難易度 |
|------|------|--------|------------|
| **電磁シールド** | 高 | 高 | 中 |
| **距離の確保** | 中 | 低 | 低 |
| **物理的隔離** | 高 | 中 | 低 |
| **ノイズ発生器** | 中 | 中 | 中 |

### 2. 技術的対策

#### 電磁波対策
```python
# 電磁波ノイズの生成例
import random
import time

def generate_em_noise():
    """電磁波ノイズを生成して信号を隠す"""
    while True:
        # ランダムな電磁波を発生
        noise = random.randint(0, 255)
        # ノイズを出力
        output_noise(noise)
        time.sleep(0.001)  # 1ms間隔
```

#### 音響対策
```python
# 音響ノイズの生成例
import numpy as np
import sounddevice as sd

def generate_audio_noise():
    """音響ノイズを生成してキーボード音を隠す"""
    # ホワイトノイズを生成
    noise = np.random.normal(0, 0.1, 44100)
    # スピーカーから出力
    sd.play(noise, samplerate=44100)
```

### 3. 運用対策
- **機密情報の分離**: 重要情報の物理的隔離
- **監視の強化**: 周辺環境の監視
- **教育・訓練**: 従業員の意識向上
- **定期点検**: 防御装置の動作確認

## 検出・監視技術

### 1. 電磁波監視
```python
# 電磁波の監視例
import numpy as np
from scipy import signal

def monitor_em_signals():
    """電磁波信号を監視して異常を検出"""
    # 電磁波センサーからデータを取得
    em_data = get_em_sensor_data()
    
    # 信号の解析
    fft = np.fft.fft(em_data)
    frequencies = np.fft.fftfreq(len(em_data))
    
    # 異常な周波数の検出
    suspicious_freqs = detect_suspicious_frequencies(fft, frequencies)
    
    if suspicious_freqs:
        alert_security_team("Suspicious EM activity detected")
```

### 2. 音響監視
```python
# 音響の監視例
import librosa
import numpy as np

def monitor_audio_signals():
    """音響信号を監視してキーボード音を検出"""
    # マイクから音声データを取得
    audio_data = get_microphone_data()
    
    # キーボード音の特徴を抽出
    mfcc = librosa.feature.mfcc(y=audio_data, sr=44100)
    
    # 機械学習モデルでキーボード音を検出
    is_keyboard = detect_keyboard_sound(mfcc)
    
    if is_keyboard:
        alert_security_team("Keyboard activity detected")
```

## 法的・規制面

### 1. 日本の法律
- **不正アクセス行為の禁止等に関する法律**: 不正アクセスの禁止
- **個人情報保護法**: 個人情報の保護
- **電波法**: 電波の利用規制

### 2. 国際規制
- **NIST SP 800-88**: アメリカのセキュリティガイドライン
- **FIPS 140-2**: 暗号モジュールのセキュリティ要件
- **Common Criteria**: セキュリティ評価基準

### 3. 業界標準
- **ISO/IEC 15408**: セキュリティ評価基準
- **FIPS 140-3**: 暗号モジュールのセキュリティ要件
- **Common Criteria EAL**: 評価保証レベル

## 実際の事例

### 1. 歴史的な事例
- **1980年代**: ソ連のテンペスト攻撃
- **1990年代**: アメリカの対策強化
- **2000年代**: 民間企業での対策導入

### 2. 最近の事例
- **2010年代**: スマートフォンでの攻撃
- **2020年代**: IoTデバイスでの攻撃
- **現在**: AIを活用した攻撃

## 将来の脅威

### 1. 技術の進歩
- **AI/ML**: 自動的な信号解析
- **量子技術**: 高感度な検出装置
- **5G**: 高速データ通信の活用

### 2. 新しい攻撃対象
- **IoTデバイス**: 多数の接続機器
- **自動車**: 車載システム
- **医療機器**: 生命維持装置

### 3. 対策の進歩
- **量子暗号**: 理論上完全な暗号
- **AI防御**: 自動的な脅威検知
- **統合防御**: 多層防御の実現

## まとめ

テンペスト攻撃は、物理的な電磁波や音響を利用した高度なサイドチャネル攻撃です。適切な防御対策を講じることで、機密情報の漏洩を防ぐことができます。

### 次のステップ
- 物理的セキュリティの強化
- 電磁波・音響の監視システム導入
- 従業員の教育・訓練
- 定期的なセキュリティ監査
