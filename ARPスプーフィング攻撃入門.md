# ARPスプーフィング攻撃入門 - ネットワークの身元を騙す攻撃を理解する

## 目次
1. [ARPスプーフィング攻撃とは何か](#arpスプーフィング攻撃とは何か)
2. [ARPプロトコルの仕組み](#arpプロトコルの仕組み)
3. [攻撃のメカニズム](#攻撃のメカニズム)
4. [攻撃の種類と手法](#攻撃の種類と手法)
5. [攻撃による被害と影響](#攻撃による被害と影響)
6. [対策方法](#対策方法)
7. [実際の攻撃例とケーススタディ](#実際の攻撃例とケーススタディ)
8. [関連する攻撃手法](#関連する攻撃手法)
9. [まとめ](#まとめ)

---

## ARPスプーフィング攻撃とは何か

### 基本定義
**ARPスプーフィング攻撃**は、ARP（Address Resolution Protocol）の仕組みを悪用して、ネットワーク上で偽のMACアドレス情報を送信し、正常な通信を妨害または盗聴する攻撃手法です。攻撃者が正当なホストのMACアドレスを偽装することで、ネットワークトラフィックを攻撃者のマシンに誘導します。

### 簡単な例え話

```
🏠 郵便配達の例：

正常な配達：
- 郵便配達員が「田中さん」宛の手紙を持参
- 田中さんの家の住所（IPアドレス）を確認
- 田中さんの家の表札（MACアドレス）を確認
- 田中さんの家に手紙を配達

ARPスプーフィング攻撃：
- 攻撃者が「田中さん」の表札を偽造
- 郵便配達員が偽の表札を信じて配達
- 攻撃者の家に手紙が届く
- 田中さんは手紙を受け取れない
```

### 攻撃の特徴

#### 透明性
```
- ユーザーは攻撃に気づかない
- 正常な通信に見える
- 攻撃者の存在が隠蔽される
```

#### 局所性
```
- 同一ネットワーク内での攻撃
- 物理的に近い場所での実行
- ネットワークスイッチの範囲内
```

#### 効果性
```
- 高い成功率
- 実装が比較的簡単
- 防御が困難
```

---

## ARPプロトコルの仕組み

### ARPの基本動作

#### 正常なARP通信
```
1. ホストAがホストBに通信したい
   - ホストAのIP: 192.168.1.10
   - ホストBのIP: 192.168.1.20

2. ホストAがARP Requestを送信
   - "192.168.1.20のMACアドレスを教えて"

3. ホストBがARP Replyを送信
   - "192.168.1.20のMACアドレスは AA:BB:CC:DD:EE:FF です"

4. ホストAがARPテーブルを更新
   - 192.168.1.20 → AA:BB:CC:DD:EE:FF
```

#### ARPパケットの構造
```
ARPパケット:
┌─────────────────────────────────────┐
│ Hardware Type (1=Ethernet)         │
├─────────────────────────────────────┤
│ Protocol Type (0x0800=IPv4)        │
├─────────────────────────────────────┤
│ Hardware Length (6)                 │
├─────────────────────────────────────┤
│ Protocol Length (4)                 │
├─────────────────────────────────────┤
│ Operation (1=Request, 2=Reply)     │
├─────────────────────────────────────┤
│ Sender Hardware Address             │
├─────────────────────────────────────┤
│ Sender Protocol Address             │
├─────────────────────────────────────┤
│ Target Hardware Address             │
├─────────────────────────────────────┤
│ Target Protocol Address             │
└─────────────────────────────────────┘
```

### ARPキャッシュの仕組み

#### ARPテーブルの構造
```
ARPテーブルの例:
┌─────────────────────────────────────┐
│ IP Address      │ MAC Address       │ Type    │
├─────────────────────────────────────┤
│ 192.168.1.1    │ 00:11:22:33:44:55  │ dynamic │
│ 192.168.1.10   │ AA:BB:CC:DD:EE:FF  │ dynamic │
│ 192.168.1.20   │ 11:22:33:44:55:66  │ dynamic │
└─────────────────────────────────────┘
```

#### キャッシュの更新
```
更新のタイミング:
1. ARP Replyを受信した時
2. 定期的なタイムアウト
3. 手動での削除
4. システム再起動時
```

### ARPの信頼性の問題

#### 信頼性の欠如
```
ARPの弱点:
- 認証機能がない
- 送信者の身元確認がない
- 偽の情報を受け入れる
- 更新の検証がない
```

#### 攻撃の可能性
```
攻撃者が利用できる弱点:
1. 認証なしでARP Replyを送信可能
2. 任意のIPアドレスを偽装可能
3. 任意のMACアドレスを偽装可能
4. 継続的に偽情報を送信可能
```

---

## 攻撃のメカニズム

### 基本的な攻撃手順

#### Step 1: 攻撃対象の特定
```
攻撃者が行う事前調査:
1. ネットワーク内のホストをスキャン
2. 攻撃対象のIPアドレスを特定
3. ゲートウェイのIPアドレスを特定
4. ネットワーク構成を把握
```

#### Step 2: 偽のARPパケットの作成
```
攻撃者が作成する偽ARPパケット:
- 送信元IP: ゲートウェイのIPアドレス
- 送信元MAC: 攻撃者のMACアドレス
- 宛先IP: 攻撃対象のIPアドレス
- 宛先MAC: 攻撃対象のMACアドレス
- 操作: ARP Reply
```

#### Step 3: 攻撃の実行
```
攻撃の流れ:
1. 攻撃者が偽のARP Replyを送信
2. 攻撃対象がARPテーブルを更新
3. 攻撃対象のトラフィックが攻撃者に流れる
4. 攻撃者がトラフィックを監視・改ざん
5. 必要に応じて正当な宛先に転送
```

### 攻撃の技術的詳細

#### 偽ARPパケットの送信
```
攻撃者が送信するパケット:
- 宛先: 攻撃対象のIPアドレス
- 内容: "ゲートウェイのIPアドレスは攻撃者のMACアドレスです"
- 結果: 攻撃対象のARPテーブルが更新される
```

#### トラフィックの誘導
```
攻撃後の通信フロー:
攻撃対象 → 攻撃者 → ゲートウェイ → インターネット

正常な通信フロー:
攻撃対象 → ゲートウェイ → インターネット
```

#### 攻撃の持続性
```
攻撃を継続する方法:
1. 定期的な偽ARPパケットの送信
2. ARPテーブルのタイムアウトを利用
3. 継続的な監視と更新
```

### 攻撃の種類

#### 1. 中間者攻撃（MITM）
```
攻撃の流れ:
1. 攻撃者が攻撃対象とゲートウェイの間に入る
2. 両方向のトラフィックを監視
3. 必要に応じてトラフィックを改ざん
4. 正当な宛先に転送
```

#### 2. セッションハイジャック
```
攻撃の流れ:
1. 攻撃者が攻撃対象のトラフィックを盗聴
2. セッション情報を取得
3. 攻撃者がセッションを乗っ取る
4. 攻撃対象になりすます
```

#### 3. サービス妨害
```
攻撃の流れ:
1. 攻撃者が攻撃対象のトラフィックを誘導
2. トラフィックを破棄または改ざん
3. 攻撃対象の通信を妨害
4. サービスを利用不能にする
```

---

## 攻撃の種類と手法

### 1. 基本的なARPスプーフィング

#### 攻撃の概要
```
攻撃の流れ:
1. 攻撃者が攻撃対象のARPテーブルを操作
2. ゲートウェイのMACアドレスを攻撃者のMACアドレスに変更
3. 攻撃対象のトラフィックを攻撃者に誘導
4. 攻撃者がトラフィックを監視・改ざん
```

#### 攻撃の特徴
- **単純**: 基本的なARPパケットの偽造
- **効果的**: 高い成功率
- **検出困難**: 正常な通信に見える

### 2. 双方向ARPスプーフィング

#### 攻撃の概要
```
攻撃の流れ:
1. 攻撃対象Aに対して「ゲートウェイは攻撃者」と偽装
2. ゲートウェイに対して「攻撃対象Aは攻撃者」と偽装
3. 両方向のトラフィックを攻撃者が中継
4. 完全な中間者攻撃を実現
```

#### 攻撃の特徴
- **完全性**: 両方向の通信を制御
- **透明性**: 攻撃対象は攻撃に気づかない
- **効果的**: 完全な通信の監視が可能

### 3. ARPキャッシュポイズニング

#### 攻撃の概要
```
攻撃の流れ:
1. 攻撃者が大量の偽ARPパケットを送信
2. ネットワーク内の全ホストのARPテーブルを汚染
3. 正常な通信を妨害
4. ネットワーク全体を混乱させる
```

#### 攻撃の特徴
- **広範囲**: ネットワーク全体に影響
- **破壊的**: 通信を完全に妨害
- **検出困難**: 複数のホストが同時に影響

### 4. 攻撃手法の比較

#### 攻撃手法の比較表
```
┌─────────────┬──────────┬──────────┬──────────┬──────────┐
│    項目     │ 基本攻撃 │ 双方向攻撃│ キャッシュ汚染│ セッション乗っ取り│
├─────────────┼──────────┼──────────┼──────────┼──────────┤
│ 実装難易度  │ 低       │ 中       │ 低       │ 高       │
│ 検出難易度  │ 中       │ 高       │ 低       │ 高       │
│ 影響範囲    │ 中       │ 中       │ 大       │ 大       │
│ 攻撃効果    │ 中       │ 高       │ 高       │ 高       │
└─────────────┴──────────┴──────────┴──────────┴──────────┘
```

---

## 攻撃による被害と影響

### 1. 直接的な被害

#### 通信の盗聴
```
被害の内容:
- パスワードの窃取
- 個人情報の窃取
- 機密情報の漏洩
- 通信内容の監視
```

#### 通信の改ざん
```
被害の内容:
- Webページの改ざん
- データの改ざん
- マルウェアの注入
- 偽情報の挿入
```

#### サービス妨害
```
被害の内容:
- インターネット接続の切断
- 特定サービスの利用不能
- ネットワーク全体の不安定化
- 業務システムの停止
```

### 2. 企業・組織への影響

#### 情報漏洩
```
影響の内容:
- 顧客情報の窃取
- 機密情報の漏洩
- 知的財産の盗用
- 法的責任の追及
```

#### 業務への影響
```
影響の内容:
- 業務システムの停止
- 顧客サービスの停止
- 売上の減少
- 信頼の失墜
```

#### 経済的損失
```
損失の内容:
- サービス停止による売上損失
- 復旧作業の費用
- セキュリティ対策の費用
- 法的責任の追及
```

### 3. 個人ユーザーへの影響

#### プライバシーの侵害
```
影響の内容:
- 個人情報の窃取
- 通信内容の監視
- 行動履歴の収集
- プライバシーの侵害
```

#### 金銭的被害
```
影響の内容:
- オンラインバンキングの不正利用
- クレジットカード情報の窃取
- 仮想通貨の窃取
- 金銭的損失
```

### 4. 攻撃の規模と頻度

#### 攻撃の統計
```
近年の傾向:
- 攻撃の巧妙化
- 攻撃頻度の増加
- 被害規模の拡大
- 対策の進歩
```

#### 影響範囲の拡大
```
影響の拡大要因:
- ネットワーク利用者の増加
- モバイルデバイスの普及
- 攻撃ツールの普及
- 攻撃者のスキル向上
```

---

## 対策方法

### 1. 基本的な対策

#### 静的ARPテーブルの設定

##### Windowsでの設定
```cmd
# 静的ARPエントリの追加
arp -s 192.168.1.1 00-11-22-33-44-55

# 静的ARPエントリの確認
arp -a

# 静的ARPエントリの削除
arp -d 192.168.1.1
```

##### Linuxでの設定
```bash
# 静的ARPエントリの追加
arp -s 192.168.1.1 00:11:22:33:44:55

# 静的ARPエントリの確認
arp -a

# 静的ARPエントリの削除
arp -d 192.168.1.1
```

#### ネットワークスイッチの設定

##### ポートセキュリティ
```
Ciscoスイッチ:
switchport port-security
switchport port-security maximum 1
switchport port-security violation restrict
switchport port-security mac-address sticky
```

##### DHCP Snooping
```
Ciscoスイッチ:
ip dhcp snooping
ip dhcp snooping vlan 1
interface range fastethernet 0/1-24
ip dhcp snooping trust
```

### 2. 高度な対策

#### ARP監視システム

##### 監視の設定
```
監視項目:
- ARPパケットの異常な増加
- 同一IPアドレスからの複数MACアドレス
- 異常なARPパケットの送信
- 定期的なARPテーブルの変更
```

##### 異常検出
```
検出方法:
- ベースラインとの比較
- 統計的分析
- 機械学習による異常検出
- リアルタイム監視
```

#### ネットワーク分離

##### VLANの活用
```
VLAN設定:
- 機密性の高いシステムを分離
- ユーザーとサーバーを分離
- ゲストネットワークの分離
- 管理ネットワークの分離
```

##### ファイアウォールの設定
```
ファイアウォール設定:
- セグメント間の通信制御
- 不要な通信のブロック
- 監視ログの収集
- 異常通信の検出
```

### 3. 運用面での対策

#### 監視とログ

##### ログ設定の強化
```
監視すべきログ:
- ARPテーブルの変更ログ
- ネットワークトラフィックログ
- セキュリティイベントログ
- システムログ
```

##### 監視項目
```
監視すべき項目:
- ARPパケットの異常な増加
- 同一IPアドレスからの複数MACアドレス
- 異常なARPパケットの送信
- 定期的なARPテーブルの変更
```

#### 定期的なセキュリティチェック

##### セキュリティ監査
```
実施すべきチェック:
1. ARPテーブルの確認
2. ネットワーク設定の確認
3. セキュリティ設定の確認
4. ログの分析
5. 脆弱性スキャン
```

##### インシデント対応
```
対応手順:
1. 攻撃の検出
2. 影響範囲の特定
3. 緊急対応の実施
4. 復旧作業の実行
5. 再発防止策の検討
```

### 4. 組織全体での対策

#### セキュリティポリシーの策定
```
ポリシーの内容:
- ARPスプーフィング対策の方針
- ネットワークセキュリティの方針
- インシデント対応の方針
- 定期的な監査の方針
```

#### 教育と訓練
```
教育内容:
- ARPスプーフィングの理解
- 攻撃手法の理解
- 対策方法の習得
- インシデント対応の訓練
```

---

## 実際の攻撃例とケーススタディ

### 1. 歴史的な攻撃事例

#### 2000年代の企業ネットワーク攻撃
```
攻撃の概要:
- 攻撃期間: 2000年代前半
- 攻撃手法: 基本的なARPスプーフィング
- 影響: 企業ネットワークでの情報漏洩
- 対策: 静的ARPテーブルの設定

攻撃の詳細:
1. 攻撃者が企業ネットワークに物理的にアクセス
2. 偽のARPパケットを送信
3. 従業員のトラフィックを盗聴
4. 機密情報を窃取
```

#### 2010年代の公共Wi-Fi攻撃
```
攻撃の概要:
- 攻撃対象: 公共Wi-Fi利用者
- 攻撃手法: ARPスプーフィング
- 影響: 個人情報の窃取
- 対策: VPNの利用推奨

攻撃の詳細:
1. 攻撃者が公共Wi-Fiに接続
2. 偽のARPパケットを送信
3. 他の利用者のトラフィックを盗聴
4. ログイン情報を窃取
```

### 2. 最近の攻撃事例

#### 2020年の企業ネットワーク攻撃
```
攻撃の概要:
- 攻撃対象: 中小企業のネットワーク
- 攻撃手法: ARPスプーフィング + 中間者攻撃
- 影響: 顧客情報の漏洩
- 対策: ネットワーク監視の強化

攻撃の詳細:
1. 攻撃者が企業ネットワークに侵入
2. ARPスプーフィングを実行
3. 顧客データベースへのアクセスを監視
4. 顧客情報を窃取
```

#### 2021年の教育機関攻撃
```
攻撃の概要:
- 攻撃対象: 大学のネットワーク
- 攻撃手法: ARPスプーフィング
- 影響: 学生情報の漏洩
- 対策: ネットワーク分離の実装

攻撃の詳細:
1. 攻撃者が大学のネットワークにアクセス
2. 偽のARPパケットを送信
3. 学生のトラフィックを盗聴
4. 個人情報を窃取
```

### 3. 攻撃の分析

#### 攻撃の成功要因
```
成功要因:
1. セキュリティ対策の不備
2. 監視体制の不足
3. インシデント対応の遅れ
4. 従業員のセキュリティ意識の低さ
```

#### 対策の効果
```
効果的な対策:
1. 静的ARPテーブルの設定
2. ネットワーク監視の強化
3. セキュリティ教育の実施
4. インシデント対応の改善
```

### 4. 学習ポイント

#### 攻撃から学ぶべきこと
```
学習ポイント:
1. セキュリティ対策の重要性
2. 継続的な監視の必要性
3. インシデント対応の重要性
4. セキュリティ教育の必要性
```

#### 対策の改善点
```
改善すべき点:
1. セキュリティ対策の見直し
2. 監視体制の強化
3. インシデント対応の改善
4. セキュリティ教育の充実
```

---

## 関連する攻撃手法

### 1. 類似する攻撃手法

#### DHCPスプーフィング
```
攻撃の概要:
- DHCPサーバーを偽装
- 偽のIPアドレス情報を配布
- トラフィックを攻撃者に誘導

違い:
- ARPスプーフィング: MACアドレスの偽装
- DHCPスプーフィング: IPアドレス情報の偽装
```

#### DNSスプーフィング
```
攻撃の概要:
- DNSサーバーを偽装
- 偽のドメイン情報を配布
- トラフィックを攻撃者に誘導

違い:
- ARPスプーフィング: ローカルネットワーク内
- DNSスプーフィング: インターネット全体
```

#### MACアドレススプーフィング
```
攻撃の概要:
- ネットワークカードのMACアドレスを変更
- 正当なデバイスになりすます
- アクセス制御を回避

違い:
- ARPスプーフィング: ARPパケットの偽造
- MACアドレススプーフィング: 物理的なMACアドレスの変更
```

### 2. 攻撃手法の進化

#### 高度な中間者攻撃
```
攻撃の概要:
- 複数の攻撃手法を組み合わせ
- より巧妙な攻撃
- より検出困難

特徴:
- 複数のプロトコルを悪用
- より高度な技術
- より効果的な攻撃
```

#### 自動化された攻撃
```
攻撃の概要:
- 攻撃ツールの自動化
- 大規模な攻撃
- 継続的な攻撃

特徴:
- 自動的な攻撃実行
- 大規模な影響
- 継続的な攻撃
```

### 3. 攻撃手法の比較

#### 攻撃手法の比較表
```
┌─────────────┬──────────┬──────────┬──────────┬──────────┐
│    項目     │ ARPスプーフィング│ DHCPスプーフィング│ DNSスプーフィング│ MACアドレススプーフィング│
├─────────────┼──────────┼──────────┼──────────┼──────────┤
│ 攻撃範囲    │ ローカル  │ ローカル  │ グローバル│ ローカル  │
│ 実装難易度  │ 低       │ 中       │ 中       │ 低       │
│ 検出難易度  │ 中       │ 中       │ 高       │ 高       │
│ 防御難易度  │ 中       │ 中       │ 高       │ 高       │
│ 影響範囲    │ 中       │ 中       │ 大       │ 中       │
└─────────────┴──────────┴──────────┴──────────┴──────────┘
```

---

## まとめ

### ARPスプーフィング攻撃の重要性
ARPスプーフィング攻撃は、ローカルネットワークでの主要な脅威の一つです。適切な理解と対策により、この攻撃から身を守ることができます。

### 攻撃の特徴
1. **透明性**: ユーザーは攻撃に気づかない
2. **局所性**: 同一ネットワーク内での攻撃
3. **効果性**: 高い成功率と攻撃効果
4. **検出困難**: 正常な通信に見える

### 対策の重要性
1. **技術的対策**: 静的ARPテーブル、ネットワーク監視
2. **運用面の対策**: 監視、ログ、インシデント対応
3. **組織的な対策**: ポリシー策定、教育、訓練
4. **継続的な改善**: 定期的な見直しと更新

### 技術の進歩
- **攻撃手法の進化**: より巧妙で複雑な攻撃
- **対策技術の発展**: より効果的な防御手段
- **監視技術の向上**: より迅速な攻撃検出
- **自動化の進歩**: 自動的な攻撃検出と対応

### 今後の展望
ネットワークセキュリティは継続的に進歩しています。最新の脅威と対策について常に学習し、実践的なスキルを身につけることが重要です。

---

## 参考資料

### 公式ドキュメント
- [RFC 826: An Ethernet Address Resolution Protocol](https://tools.ietf.org/html/rfc826)
- [RFC 5227: IPv4 Address Conflict Detection](https://tools.ietf.org/html/rfc5227)
- [RFC 5227: IPv4 Address Conflict Detection](https://tools.ietf.org/html/rfc5227)

### セキュリティ情報
- [CERT Advisory CA-2001-09: ARP Spoofing](https://www.cert.org/historical/advisories/CA-2001-09.cfm)
- [NIST Special Publication 800-94: Guide to Intrusion Detection and Prevention Systems](https://csrc.nist.gov/publications/detail/sp/800-94/final)
- [SANS Internet Storm Center](https://isc.sans.edu/)

### 攻撃事例と対策
- [ARP Spoofing Attack Analysis](https://www.sans.org/white-papers/36977/)
- [Network Security Monitoring](https://www.sans.org/white-papers/36977/)
- [Intrusion Detection Systems](https://www.sans.org/white-papers/36977/)

### ツールとリソース
- [ARP Spoofing Detection Tools](https://github.com/byt3bl33d3r/arpspoof)
- [Network Security Monitoring Tools](https://www.wireshark.org/)
- [Intrusion Detection Systems](https://www.snort.org/)

---

*この文書はARPスプーフィング攻撃の基本概念を理解するための入門資料です。実際の実装や運用については、具体的な製品のドキュメントや専門的なトレーニングを参照してください。*
