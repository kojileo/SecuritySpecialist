# TPM入門

## TPMとは

TPM（Trusted Platform Module）は、**ハードウェアベースのセキュリティチップ**です。コンピュータの基板上に組み込まれ、暗号化処理やセキュリティ機能を提供することで、システムの信頼性とセキュリティを向上させます。

## TPMの基本概念

### 信頼の基点（Root of Trust）

TPMは**信頼の基点**として機能し、以下の要素を提供します：

- **ハードウェアベースのセキュリティ**: ソフトウェアでは改ざん困難
- **暗号化キーの安全な保存**: チップ内で暗号化して保存
- **整合性検証**: システムの状態を検証
- **認証機能**: デバイスの真正性を証明

### 物理的な特徴

| 項目 | 詳細 |
|------|------|
| **形状** | 小さなチップ（約1cm四方） |
| **接続** | マザーボードに直接実装 |
| **電源** | システム電源と連動 |
| **通信** | LPCバスまたはSPIバス経由 |

## TPMの主要機能

### 1. 暗号化キー管理

```
機能: 暗号化キーの生成・保存・管理
特徴: チップ内で暗号化して保存
用途: ディスク暗号化、デジタル署名
```

**例**: BitLockerで使用される暗号化キーをTPM内で安全に保存

### 2. プラットフォーム整合性検証

```
機能: システムの起動時状態を測定・検証
特徴: 改ざん検出が可能
用途: セキュアブート、システム監査
```

**例**: 起動時にBIOS、OS、ドライバーの整合性を検証

### 3. デバイス認証

```
機能: デバイスの真正性を証明
特徴: ハードウェア固有の識別子
用途: リモートアクセス、デバイス管理
```

**例**: 企業ネットワークへの接続時にデバイスを認証

### 4. 安全な乱数生成

```
機能: 暗号学的に安全な乱数を生成
特徴: ハードウェアベースの真の乱数
用途: 暗号化、認証、セッション管理
```

## TPMのバージョン

### TPM 1.2

| 項目 | 詳細 |
|------|------|
| **リリース** | 2009年 |
| **暗号化** | RSA、SHA-1 |
| **特徴** | 基本的なセキュリティ機能 |
| **用途** | 従来のセキュリティアプリケーション |

### TPM 2.0

| 項目 | 詳細 |
|------|------|
| **リリース** | 2014年 |
| **暗号化** | RSA、ECC、SHA-256 |
| **特徴** | より柔軟で強力な機能 |
| **用途** | 現代のセキュリティ要件に対応 |

### 主な違い

| 機能 | TPM 1.2 | TPM 2.0 |
|------|---------|---------|
| **暗号化アルゴリズム** | 限定的 | 多様 |
| **キー管理** | 固定的 | 柔軟 |
| **認証方式** | パスワード | 多要素認証 |
| **パフォーマンス** | 標準 | 向上 |

## 実際の使用例

### 1. Windows BitLocker

```
機能: ディスク暗号化
TPMの役割: 暗号化キーの保護
利点: パスワードなしで自動復号化
```

**設定例**:
- TPM + PIN認証
- TPM + USBキー認証
- TPM + 生体認証

### 2. セキュアブート

```
機能: 起動時の整合性検証
TPMの役割: 起動プロセスの測定
利点: マルウェア感染の防止
```

**検証対象**:
- BIOS/UEFI
- ブートローダー
- OSカーネル
- ドライバー

### 3. リモートアクセス

```
機能: VPN接続時のデバイス認証
TPMの役割: デバイス証明書の管理
利点: デバイス固有の認証
```

**企業での活用**:
- リモートワーク環境
- デバイス管理
- コンプライアンス対応

## TPMの有効化と確認

### Windowsでの確認方法

#### 1. TPMの状態確認
```powershell
# PowerShellで実行
Get-Tpm
```

#### 2. デバイスマネージャーでの確認
```
デバイスマネージャー → セキュリティデバイス → Trusted Platform Module
```

#### 3. システム情報での確認
```
msinfo32 → コンポーネント → セキュリティ → TPM
```

### BIOS/UEFIでの設定

| 設定項目 | 説明 |
|----------|------|
| **TPM** | 有効/無効 |
| **TPM State** | 有効化 |
| **TPM Support** | サポート有効 |
| **Security Device Support** | セキュリティデバイス有効 |

## セキュリティ上の利点

### 1. ハードウェアベースの保護

- **物理的保護**: チップの改ざんは困難
- **ソフトウェア攻撃への耐性**: マルウェアでは改ざん不可
- **永続性**: 電源を切ってもデータ保持

### 2. 暗号化の強化

- **キーの分離**: アプリケーションから分離
- **安全な生成**: 真の乱数によるキー生成
- **改ざん検出**: キーの整合性検証

### 3. 認証の信頼性

- **デバイス固有**: ハードウェアベースの識別
- **改ざん困難**: 物理的な保護
- **監査証跡**: アクセス履歴の記録

## 注意点と制限事項

### セキュリティリスク

| リスク | 説明 | 対策 |
|--------|------|------|
| **物理的攻撃** | チップの直接的な改ざん | 物理的セキュリティの確保 |
| **ファームウェア攻撃** | TPMファームウェアの改ざん | 定期的な更新 |
| **キー漏洩** | メモリダンプによる漏洩 | 適切なアクセス制御 |

### 運用上の注意

- **バックアップ**: TPMキーのバックアップ戦略
- **更新**: ファームウェアの定期的な更新
- **監視**: TPMイベントの監視とログ管理
- **テスト**: 定期的な機能テスト

## まとめ

TPMは**ハードウェアベースのセキュリティ基盤**として、現代のコンピュータセキュリティに不可欠な技術です。暗号化キーの保護、システム整合性の検証、デバイス認証など、多様なセキュリティ機能を提供し、個人ユーザーから企業まで幅広く活用されています。

適切に設定・運用することで、マルウェア感染の防止、データの保護、システムの信頼性向上を実現できます。

---

*この資料はネットワークセキュリティの基礎学習用です。実際の設定や運用では、詳細な技術仕様書を参照してください。*
